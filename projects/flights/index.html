<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="styles.css">
	<title>Flights visualization</title>
</head>

<body>
	
	<div id="title"></div>
	<div id="invert-btn"></div>
	<div id="graph"></div>
	<div id="description"></div>

	<script src="airports.js"></script>
	<script src="connections.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://d3js.org/d3.hive.v0.min.js"></script>
<script>

d3.select("#invert-btn").on('click', function () {
	var body = d3.select("body");
	var clas = "inverted";
	body.classed(clas, !body.classed(clas));
});

var width = 1280,
    height = 720,
    innerRadius = 10,
    outerRadius = 450;
	
var angle = d3.scale.ordinal().domain(d3.range(4)).rangePoints([0, 2 * Math.PI]),
    radius = d3.scale.linear().range([innerRadius, outerRadius]).nice(),
    color = d3.scale.category20().domain(d3.range(20));


var svg = d3.select("#graph").append("svg")
	.attr("viewBox", "0, 0, " + width + ", " + height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

svg.selectAll(".axis")
    .data(d3.range(3))
  .enter().append("line")
    .attr("class", "axis")
    .attr("transform", function(d) { return "rotate(" + degrees(angle(d)) + ")"; })
    .attr("x1", radius.range()[0])
    .attr("x2", radius.range()[1]*1.05);

svg.selectAll(".link")
    .data(links)
  .enter().append("path")
    .attr("class", "link")
    .attr("d", d3.hive.link()
    .angle(function(d) { return d?angle(d.x):0; })
    .radius(function(d) { return d?radius(d.y):0; }));
    //.style("stroke", function(d) { return "rgba(0,255,0,0.05)"; }); //color(d.source?d.source.x:0)

svg.selectAll(".node")
    .data(nodes)
  .enter().append("circle")
	.attr("class", function(d) { return "node " + d.x; })
	.attr("data-name", function(d) { return d.name; })
    .attr("transform", function(d) { return "rotate(" + degrees(angle(d.x)) + ")"; })
    .attr("cx", function(d) { return radius(d.y); })
    .attr("r", function(d) { return Math.sqrt(d.count * 8); })
	.append("svg:title")
          .text(function(d) { return d.name; });
    //.style("fill", function(d) { return color(d.x); });

	
function degrees(radians) {
  return radians / Math.PI * 180 - 90;
}



</script>
</body>
</html>